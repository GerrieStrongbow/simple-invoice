.print-only {
  display: none;
}

/* Hover zone indicators for column addition */
thead tr th:hover {
  position: relative;
}

thead tr th:not(:first-child)::before {
  content: '';
  position: absolute;
  left: -2px;
  top: 20%;
  bottom: 20%;
  width: 4px;
  background: transparent;
  transition: background 0.2s ease;
  pointer-events: none;
}

thead tr th:not(:first-child):hover::before {
  background: linear-gradient(to bottom, transparent, #0284c7, transparent);
  opacity: 0.3;
}

@media print {
  /* Universal print settings - consolidated */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    visibility: hidden;
    page-break-after: auto !important;
  }

  /* Body settings - consolidated */
  body {
    background: white !important;
    background-color: white !important;
    padding: 0 !important;
    margin: 0 !important;
    height: auto !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Show only the invoice container and its contents */
  .invoice-container,
  .invoice-container * {
    visibility: visible;
  }

  /* Style the invoice container for print - consolidated */
  .invoice-container {
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    width: 100% !important;
    height: auto !important;
    max-height: none !important;
    background: white !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    padding: 18px !important;
    padding-bottom: 0 !important;
    margin: 0 !important;
    margin-bottom: 0 !important;
    max-width: none !important;
    font-size: 14px !important;
    line-height: 1.2 !important;
    display: block !important;
    page-break-inside: avoid !important;
    page-break-after: avoid !important;
    break-inside: avoid !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Hide non-printable elements */
  .no-print,
  header,
  footer,
  nav,
  button,
  [role="button"] {
    display: none !important;
    visibility: hidden !important;
  }

  /* Show print-only elements */
  .print-only {
    display: inline !important;
    visibility: visible !important;
  }

  /* Clean up input styling for print */
  input[type="text"] {
    background: transparent !important;
    border: none !important;
    padding: 2px 4px !important;
    outline: none !important;
    box-shadow: none !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
    font-size: inherit !important;
    font-weight: inherit !important;
    color: inherit !important;
  }

  /* Hide all editable borders in print */
  span[contenteditable] {
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
    outline: none !important;
    box-shadow: none !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Hide date inputs completely and show formatted dates instead */
  input[type="date"] {
    color: transparent !important;
    background: transparent !important;
    border: none !important;
    padding: 2px 4px !important;
    outline: none !important;
    box-shadow: none !important;
  }

  /* Hide date picker elements */
  input[type="date"]::-webkit-calendar-picker-indicator {
    display: none !important;
  }

  input[type="date"]::-webkit-inner-spin-button,
  input[type="date"]::-webkit-outer-spin-button {
    display: none !important;
  }

  /* Bank details section - consolidated */
  .bank-details {
    background: #fafaf8 !important;
    border: 1px solid #e7e5e0 !important;
    padding: 8px !important;
    margin-top: 10px !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  .bank-details h4 {
    margin-bottom: 4px !important;
    font-family: "Instrument Serif", var(--font-display), Georgia, "Times New Roman", serif !important;
    font-style: italic !important;
  }

  .bank-details .grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
  }

  .bank-details .flex.flex-col {
    gap: 4px !important;
  }

  .bank-details .flex.items-center {
    gap: 4px !important;
  }

  .bank-details input[type="text"] {
    padding: 2px 6px !important;
    font-size: 14px !important;
    height: 20px !important;
    line-height: 1.2 !important;
  }

  /* Preserve table styling with optimized spacing */
  .services-table th {
    background: linear-gradient(135deg, #fafaf8 0%, #f5f4f0 100%) !important;
    padding: 4px !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  .services-table td {
    padding: 3px 5px !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  .services-table input {
    padding: 3px 6px !important;
    font-size: 12px !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Clean table styling */
  .services-table {
    width: 100% !important;
    margin: 0 !important;
    table-layout: fixed !important;
  }

  /* Services table column widths and alignment - consolidated */
  .services-table th:first-child,
  .services-table td:first-child {
    width: 58% !important;
    text-align: left !important;
  }

  .services-table th:nth-child(2),
  .services-table td:nth-child(2) {
    width: 14% !important;
  }

  .services-table th:nth-child(3),
  .services-table td:nth-child(3) {
    width: 14% !important;
  }

  .services-table th:nth-child(4),
  .services-table td:nth-child(4) {
    width: 14% !important;
  }

  .services-table td:first-child input {
    white-space: normal !important;
    word-break: break-word !important;
    height: auto !important;
  }

  .services-table th input {
    text-align: inherit !important;
  }

  .services-table th,
  .services-table td {
    text-align: right !important;
  }

  .services-table td input {
    text-align: right !important;
  }

  .services-table td:first-child input,
  .services-table td:first-child textarea {
    text-align: left !important;
  }

  /* Table settings - consolidated */
  table {
    width: 100% !important;
    border-collapse: collapse !important;
  }

  .invoice-container h1 {
    font-size: 48px !important;
    margin: 0 !important;
    line-height: 1 !important;
    font-family: "Instrument Serif", var(--font-display), Georgia, "Times New Roman", serif !important;
    font-weight: 400 !important;
  }

  .invoice-container h3 {
    font-size: 15px !important;
    margin: 0 0 6px 0 !important;
    line-height: 1.2 !important;
    font-family: "Instrument Serif", var(--font-display), Georgia, "Times New Roman", serif !important;
    font-style: normal !important;
  }

  .invoice-container h4 {
    font-size: 14px !important;
    margin: 0 0 4px 0 !important;
    line-height: 1.2 !important;
    font-family: "Instrument Serif", var(--font-display), Georgia, "Times New Roman", serif !important;
    font-style: normal !important;
  }

  /* Ensure all text elements use optimized spacing */
  .invoice-container input,
  .invoice-container span,
  .invoice-container div,
  .invoice-container td,
  .invoice-container th {
    font-size: inherit !important;
    line-height: 1.2 !important;
  }

  /* Optimize vertical spacing between sections */
  .invoice-container > div {
    margin-bottom: 10px !important;
  }

  .invoice-container > div:first-child {
    padding: 16px !important;
  }

  /* Optimize the header section */
  .invoice-header {
    padding-bottom: 10px !important;
    margin-bottom: 12px !important;
    flex-direction: row !important;
    align-items: flex-start !important;
  }

  .invoice-header h1 input {
    padding: 0 !important;
    font-size: 48px !important;
    font-family: "Instrument Serif", var(--font-display), Georgia, "Times New Roman", serif !important;
    font-weight: 400 !important;
    font-style: normal !important;
  }

  /* Invoice details section - consolidated */
  .invoice-details {
    text-align: right !important;
  }

  .invoice-details > div {
    height: 20px !important;
    gap: 4px !important;
    margin-bottom: 4px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
  }

  /* Optimize From/To sections */
  .from-to-section {
    margin-bottom: 10px !important;
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 10px !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  .from-to-section > div {
    padding: 8px !important;
  }

  .from-to-section input[type="text"] {
    padding: 2px 6px !important;
    font-size: 14px !important;
    height: 20px !important;
    line-height: 1.2 !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  .from-to-section .flex-col {
    gap: 4px !important;
  }

  .from-to-section .flex.items-center {
    gap: 4px !important;
  }

  .from-to-section h3,
  .from-to-section h4 {
    margin-bottom: 4px !important;
  }

  .from-to-section div {
    margin-bottom: 2px !important;
  }

  /* Ensure consistent label width for proper alignment */
  .invoice-details span[contenteditable] {
    min-width: 95px !important;
    width: 95px !important;
    text-align: right !important;
    white-space: nowrap !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
    line-height: 1 !important;
    padding: 0 !important;
    margin: 0 !important;
    height: 20px !important;
  }

  /* Make all inputs in header have consistent width and proper alignment */
  .invoice-details input[type="text"],
  .invoice-details input[type="date"] {
    width: 110px !important;
    min-width: 110px !important;
    max-width: 110px !important;
    text-align: right !important;
    padding: 2px 6px !important;
    margin: 0 !important;
    line-height: 1 !important;
    height: 20px !important;
    display: inline-flex !important;
    align-items: center !important;
    font-size: 13px !important;
    box-sizing: border-box !important;
  }

  /* Remove grey boxes from totals */
  .total-section span[style*="background"],
  .total-row span[style*="backgroundColor"] {
    background: transparent !important;
    background-color: transparent !important;
    border: none !important;
    padding: 0 !important;
  }

  .total-section input[type="text"] {
    padding: 4px 8px !important;
    font-size: 13px !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Total section - consolidated */
  .total-section {
    margin-top: 16px !important;
    padding-top: 10px !important;
    border-top: 1px solid #e7e5e0 !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    font-family: var(--font-body), system-ui, -apple-system, sans-serif !important;
  }

  /* Optimize total rows spacing */
  .total-row {
    margin-bottom: 3px !important;
  }

  /* Ensure proper page margins and prevent blank pages */
  @page {
    margin: 0.6in !important;
    size: A4 !important;
  }

  /* Ensure no extra height anywhere */
  html {
    height: auto !important;
  }

  /* Specifically prevent page break on last element */
  .invoice-container > *:last-child,
  .invoice-container > div:last-child,
  .notes-section {
    page-break-after: avoid !important;
    page-break-inside: avoid !important;
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  /* Hide any invisible spacer elements that might cause blank pages */
  div:empty {
    display: none !important;
  }

  /* Ensure the table container spans full width */
  .services-table-container,
  div:has(.services-table) {
    width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
    margin-right: 0 !important;
  }

  /* Override any inline styles on table container */
  [style*="marginRight"] {
    margin-right: 0 !important;
  }

  /* Ensure proper spacing */
  .header {
    margin-bottom: 18px !important;
  }

  .details-grid {
    margin-bottom: 16px !important;
  }
}
