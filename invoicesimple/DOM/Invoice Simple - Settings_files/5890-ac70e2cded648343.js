!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="e73fded4-8d41-40be-a2aa-b98b437f4b52",t._sentryDebugIdIdentifier="sentry-dbid-e73fded4-8d41-40be-a2aa-b98b437f4b52")}catch(t){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5890],{55156:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(58399),i=n(86619),a=n(14864);function o(t){(0,a.Z)(1,arguments);var e=(0,i.Z)(t);return(0,r.Z)(1e3*e)}},70517:function(t,e,n){"use strict";n.r(e),n.d(e,{Address:function(){return tv},BaseItem:function(){return tP},Contact:function(){return tE},DocumentItem:function(){return tk},ItemDiscountType:function(){return tj},NoAddress:function(){return tp},OptionalAddress:function(){return ty},OptionalEmail:function(){return tS},ValidEmail:function(){return t_},ValidInvoiceNumber:function(){return tU},createDefaultCompany:function(){return tT},createDefaultContact:function(){return tO},createDefaultDocumentItem:function(){return tI},createDefaultEstimate:function(){return tR},createDefaultEstimateSettings:function(){return tC},createDefaultInvoice:function(){return tA},createDefaultInvoiceSettings:function(){return tF},isEstimate:function(){return tL},isInvoice:function(){return tD},isReceipt:function(){return tN}});var r,i,a,o,s,u,l,c,f,h,d,g,v,p=n(83257),y=n(50833);n(37237),n(26828);var m=n(43603);n(44192),n(54926),y.Z.DP=5,y.Z.RM=1,(0,y.Z)(0),(0,y.Z)(100),(_=S||(S={})).IOS="ios",_.ANDROID="android",_.WEB="web";var _,S,E,b,O,T,I,w={DOCTYPE_INVOICE:0,DOCTYPE_ESTIMATE:1,DOCTYPE_STATEMENT:2};(A=E||(E={})).PAYMENTS_TIER="paymentsTier",A.STARTER="starter",A.ESSENTIALS="essentials",A.PRO="pro",A.PLUS="plus",A.PREMIUM="premium",A.ESSENTIALS_LEGACY="essentialsLegacy",A.PLUS_LEGACY="plusLegacy",A.PREMIUM_LEGACY="premiumLegacy",(F=b||(b={})).SMS_PROMOTIONAL="sms_promotional",F.EMAIL_TRANSACTIONAL="email_transactional",F.EMAIL_PROMOTIONAL="email_promotional",F.PASSING_FEES_SURCHARGE="passing_fees_surcharge",F.STRIPE_ONBOARDING="stripe_onboarding",F.PAYPAL_ONBOARDING="paypal_onboarding",F.REFERRAL_PROGRAM="referral_program",F.FREE_SAAS="free_saas",(C=O||(O={})).CONSENT_GIVEN="consent_given",C.CONSENT_REVOKED="consent_revoked",C.CONSENT_NOT_GIVEN="consent_not_given",C.CONSENT_IMPLICIT="consent_implicit",(R=T||(T={}))[R.MARKUP=0]="MARKUP",R[R.SURCHARGE=1]="SURCHARGE",(L=I||(I={})).DEPOSIT="Deposit",L.PAYMENT="Payment";var A,F,C,R,L,D,N=function(t){return"Left"===t._tag},P=(D=function(t,e){return(D=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),j=function(){return(j=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},k=function(t){return{_tag:"Left",left:t}},x=function(t,e,n){return k([{value:t,context:e,message:n}])},U=function(t){return{_tag:"Right",right:t}},M=function(){function t(t,e,n,r){this.name=t,this.is=e,this.validate=n,this.encode=r,this.decode=this.decode.bind(this)}return t.prototype.pipe=function(e,n){var r=this;return void 0===n&&(n="pipe(".concat(this.name,", ").concat(e.name,")")),new t(n,e.is,function(t,n){var i=r.validate(t,n);return N(i)?i:e.validate(i.right,n)},this.encode===G&&e.encode===G?G:function(t){return r.encode(e.encode(t))})},t.prototype.asDecoder=function(){return this},t.prototype.asEncoder=function(){return this},t.prototype.decode=function(t){return this.validate(t,[{key:"",type:this,actual:t}])},t}(),G=function(t){return t};function V(t,e,n,r){for(var i=t.length,a=Array(i+1),o=0;o<i;o++)a[o]=t[o];return a[i]={key:e,type:n,actual:r},a}function J(t,e){for(var n=e.length,r=0;r<n;r++)t.push(e[r])}var Z=Object.prototype.hasOwnProperty;function Y(t){for(var e=0;e<t.length;e++)if(t[e].encode!==G)return!1;return!0}function B(t){return"{ ".concat(Object.keys(t).map(function(e){return"".concat(e,": ").concat(t[e].name)}).join(", ")," }")}function H(t,e){for(var n=!0,r=!0,i=!tn.is(t),a=0;a<e.length;a++)(u=e[a])!==t&&(n=!1),tn.is(u)&&(r=!1);if(n)return t;if(r)return e[e.length-1];for(var o={},s=0;s<e.length;s++){var u=e[s];for(var l in u)Z.call(o,l)&&!i&&u[l]===t[l]||(o[l]=u[l])}return o}var q={};function K(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r];-1!==e.indexOf(i)&&n.push(i)}return n}var W=[];function Q(t){if(-1!==W.indexOf(t))return q;if("InterfaceType"===t._tag||"StrictType"===t._tag){var e=q;for(var n in t.props){var r=t.props[n];"LiteralType"===r._tag&&(e===q&&(e={}),e[n]=[r.value])}return e}if("ExactType"===t._tag||"RefinementType"===t._tag||"ReadonlyType"===t._tag)return Q(t.type);if("IntersectionType"===t._tag)return t.types.reduce(function(t,e){return function(t,e){if(t===q)return e;if(e===q)return t;var n=Object.assign({},t);for(var r in e)if(Z.call(t,r)){var i=K(t[r],e[r]);if(!(i.length>0)){n=q;break}n[r]=i}else n[r]=e[r];return n}(t,Q(e))},q);if("UnionType"===t._tag)return t.types.slice(1).reduce(function(t,e){return function(t,e){if(t===q||e===q)return q;var n=q;for(var r in t)Z.call(e,r)&&0===K(t[r],e[r]).length&&(n===q&&(n={}),n[r]=t[r].concat(e[r]));return n}(t,Q(e))},Q(t.types[0]));if("RecursiveType"===t._tag){W.push(t);var i=Q(t.type);return W.pop(),i}return q}new(function(t){function e(){var e=t.call(this,"null",function(t){return null===t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="NullType",e}return P(e,t),e}(M));var z=new(function(t){function e(){var e=t.call(this,"undefined",function(t){return void 0===t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="UndefinedType",e}return P(e,t),e}(M));new(function(t){function e(){var e=t.call(this,"void",z.is,z.validate,G)||this;return e._tag="VoidType",e}return P(e,t),e}(M)),new(function(t){function e(){var e=t.call(this,"unknown",function(t){return!0},U,G)||this;return e._tag="UnknownType",e}return P(e,t),e}(M));var $=new(function(t){function e(){var e=t.call(this,"string",function(t){return"string"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="StringType",e}return P(e,t),e}(M)),X=new(function(t){function e(){var e=t.call(this,"number",function(t){return"number"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="NumberType",e}return P(e,t),e}(M));new(function(t){function e(){var e=t.call(this,"bigint",function(t){return"bigint"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="BigIntType",e}return P(e,t),e}(M));var tt=new(function(t){function e(){var e=t.call(this,"boolean",function(t){return"boolean"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="BooleanType",e}return P(e,t),e}(M));new(function(t){function e(){var e=t.call(this,"UnknownArray",Array.isArray,function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="AnyArrayType",e}return P(e,t),e}(M));var te,tn=new(function(t){function e(){var e=t.call(this,"UnknownRecord",function(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="AnyDictionaryType",e}return P(e,t),e}(M)),tr=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.value=a,o._tag="LiteralType",o}return P(e,t),e}(M);function ti(t,e){void 0===e&&(e=JSON.stringify(t));var n=function(e){return e===t};return new tr(e,n,function(e,r){return n(e)?U(t):x(e,r)},G,t)}P(function(t,e,n,r,i){var a=te.call(this,t,e,n,r)||this;return a.keys=i,a._tag="KeyofType",a},te=M);var ta=function(t){function e(e,n,r,i,a,o){var s=t.call(this,e,n,r,i)||this;return s.type=a,s.predicate=o,s._tag="RefinementType",s}return P(e,t),e}(M);td(X,function(t){return Number.isInteger(t)},"Int"),Object.defineProperty(function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.runDefinition=a,o._tag="RecursiveType",o}return P(e,t),e}(M).prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0}),P(function(t,e,n,i,a){var o=r.call(this,t,e,n,i)||this;return o.type=a,o._tag="ArrayType",o},r=M);var to=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.props=a,o._tag="InterfaceType",o}return P(e,t),e}(M);function ts(t,e){void 0===e&&(e=B(t));var n=Object.keys(t),r=n.map(function(e){return t[e]}),i=n.length;return new to(e,function(t){if(tn.is(t)){for(var e=0;e<i;e++){var a=n[e],o=t[a];if(void 0===o&&!Z.call(t,a)||!r[e].is(o))return!1}return!0}return!1},function(t,e){var a=tn.validate(t,e);if(N(a))return a;for(var o=a.right,s=o,u=[],l=0;l<i;l++){var c=n[l],f=s[c],h=r[l],d=h.validate(f,V(e,c,h,f));if(N(d))J(u,d.left);else{var g=d.right;g===f&&(void 0!==g||Z.call(s,c))||(s===o&&(s=j({},o)),s[c]=g)}}return u.length>0?k(u):U(s)},Y(r)?G:function(t){for(var e=j({},t),a=0;a<i;a++){var o=n[a],s=r[a].encode;s!==G&&(e[o]=s(t[o]))}return e},t)}var tu=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.props=a,o._tag="PartialType",o}return P(e,t),e}(M);P(function(t,e,n,r,a,o){var s=i.call(this,t,e,n,r)||this;return s.domain=a,s.codomain=o,s._tag="DictionaryType",s},i=M);var tl=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.types=a,o._tag="UnionType",o}return P(e,t),e}(M);function tc(t,e){void 0===e&&(e="("+t.map(function(t){return t.name}).join(" | ")+")");var n=function(t){for(var e=Q(t[0]),n=Object.keys(e),r=t.length,i=0;i<n.length;i++){var a=function(n){for(var i=e[n].slice(),a=[e[n]],o=1;o<r;o++){var s=Q(t[o])[n];if(void 0===s||s.some(function(t){return -1!==i.indexOf(t)}))return"continue-keys";i.push.apply(i,s),a.push(s)}return{value:[n,a]}}(n[i]);if("object"==typeof a)return a.value}}(t);if(void 0!==n&&t.length>0){var r=n[0],i=n[1],a=i.length,o=function(t){for(var e=0;e<a;e++)if(-1!==i[e].indexOf(t))return e};return new tg(e,function(e){if(tn.is(e)){var n=o(e[r]);return void 0!==n&&t[n].is(e)}return!1},function(e,n){var i=tn.validate(e,n);if(N(i))return i;var a=i.right,s=o(a[r]);if(void 0===s)return x(e,n);var u=t[s];return u.validate(a,V(n,String(s),u,a))},Y(t)?G:function(n){var i=o(n[r]);if(void 0===i)throw Error("no codec found to encode value in union codec ".concat(e));return t[i].encode(n)},t,r)}return new tl(e,function(e){return t.some(function(t){return t.is(e)})},function(e,n){for(var r=[],i=0;i<t.length;i++){var a=t[i],o=a.validate(e,V(n,String(i),a,e));if(!N(o))return U(o.right);J(r,o.left)}return k(r)},Y(t)?G:function(n){for(var r=0;r<t.length;r++){var i=t[r];if(i.is(n))return i.encode(n)}throw Error("no codec found to encode value in union type ".concat(e))},t)}var tf=function(t){function e(e,n,r,i,a){var o=t.call(this,e,n,r,i)||this;return o.types=a,o._tag="IntersectionType",o}return P(e,t),e}(M);function th(t,e){void 0===e&&(e="(".concat(t.map(function(t){return t.name}).join(" & "),")"));var n=t.length;return new tf(e,function(e){return t.every(function(t){return t.is(e)})},0===t.length?U:function(e,r){for(var i=[],a=[],o=0;o<n;o++){var s=t[o],u=s.validate(e,V(r,String(o),s,e));N(u)?J(a,u.left):i.push(u.right)}return a.length>0?k(a):U(H(e,i))},0===t.length?G:function(e){return H(e,t.map(function(t){return t.encode(e)}))},t)}function td(t,e,n){return void 0===n&&(n="(".concat(t.name," | ").concat(e.displayName||e.name||"<function".concat(e.length,">"),")")),new ta(n,function(n){return t.is(n)&&e(n)},function(n,r){var i=t.validate(n,r);if(N(i))return i;var a=i.right;return e(a)?U(a):x(a,r)},t.encode,t,e)}P(function(t,e,n,r,i){var o=a.call(this,t,e,n,r)||this;return o.types=i,o._tag="TupleType",o},a=M),P(function(t,e,n,r,i){var a=o.call(this,t,e,n,r)||this;return a.type=i,a._tag="ReadonlyType",a},o=M),P(function(t,e,n,r,i){var a=s.call(this,t,e,n,r)||this;return a.type=i,a._tag="ReadonlyArrayType",a},s=M),P(function(t,e,n,r,i){var a=u.call(this,t,e,n,r)||this;return a.type=i,a._tag="ExactType",a},u=M),new(function(t){function e(){var e=t.call(this,"Function",function(t){return"function"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="FunctionType",e}return P(e,t),e}(M)),new(function(t){function e(){var e=t.call(this,"never",function(t){return!1},function(t,e){return x(t,e)},function(){throw Error("cannot encode never")})||this;return e._tag="NeverType",e}return P(e,t),e}(M)),new(function(t){function e(){var e=t.call(this,"any",function(t){return!0},U,G)||this;return e._tag="AnyType",e}return P(e,t),e}(M)),td(X,Number.isInteger,"Integer");var tg=function(t){function e(e,n,r,i,a,o){var s=t.call(this,e,n,r,i,a)||this;return s.tag=o,s}return P(e,t),e}(tl);new(function(t){function e(){var e=t.call(this,"object",function(t){return null!==t&&"object"==typeof t},function(t,n){return e.is(t)?U(t):x(t,n)},G)||this;return e._tag="ObjectType",e}return P(e,t),e}(M)),P(function(t,e,n,r,i){var a=l.call(this,t,e,n,r)||this;return a.props=i,a._tag="StrictType",a},l=M);var tv=ts({address1:$,address2:tc([$,z]),address3:tc([$,z])}),tp=ts({address1:z}),ty=tc([tv,tp]),tm=/.+@.+\..+/,t_=td($,function(t){return"string"==typeof t&&tm.test(t.trim())},"ValidEmail"),tS=tc([t_,z]),tE=th([ts({name:tc([$,z]),email:tS,secondaryEmail:tS,phone:tc([$,z]),fax:tc([$,z]),mobile:tc([$,z])}),ty]);function tb(){return(tb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function tO(){return{name:void 0,email:void 0,secondaryEmail:void 0,address1:void 0,phone:void 0,fax:void 0,mobile:void 0}}function tT(){return tb({},{name:void 0,email:void 0,secondaryEmail:void 0,address1:void 0,phone:void 0,fax:void 0,mobile:void 0},{remoteId:(0,p.Z)(),businessNumber:void 0,company:void 0,website:void 0,ownerName:void 0})}function tI(){return{code:"",description:"",rate:0,taxable:!0,remoteId:(0,p.Z)(),quantity:1,taxRate:0,discountRate:0,discountType:0}}function tw(){var t,e=new Date,n=tT(),r=tI();return{remoteId:(0,p.Z)(),objectId:void 0,poNumber:void 0,title:void 0,signature:void 0,notes:void 0,company:n,client:void 0,items:[r],createDate:new Date,photos:[],sentStatus:void 0,invoiceDate:(void 0===t&&(t="yyyy-MM-dd"),(0,m.Z)(e,t)),deleted:!1,updated:e.getTime(),platform:void 0}}function tA(t,e){return tb({},tw(),{docType:w.DOCTYPE_INVOICE,invoiceNo:t,setting:e,payments:[]})}function tF(t){var e=t.taxLabelPlaceHolder;return{remoteId:(0,p.Z)(),termsDay:0,taxType:0,taxLabel:e,taxRate:0,taxInclusive:!1,discountAmount:0,discountRate:0,discountType:0,color:null,template:null,fullyPaid:void 0,optionQtyRate:!1,paidDate:void 0,dueDate:void 0,paymentSuppressed:void 0,stripePaymentSuppressed:void 0,estimateId:void 0,depositType:void 0,depositRate:void 0,depositAmount:void 0,feesType:void 0,acornFinancing:void 0}}function tC(t){var e=t.taxLabelPlaceHolder;return{remoteId:(0,p.Z)(),taxType:0,taxLabel:e,taxRate:0,taxInclusive:!1,discountAmount:0,discountRate:0,discountType:0,color:null,template:null,fullyPaid:!1,optionQtyRate:!1,estimateSignatureRequired:null,estimateSignedText:null,estimateSignedAt:null,acornFinancing:null}}function tR(t,e){return tb({},tw(),{docType:w.DOCTYPE_ESTIMATE,invoiceNo:t,setting:e})}function tL(t){return t&&t.docType===w.DOCTYPE_ESTIMATE}function tD(t){return t&&t.docType===w.DOCTYPE_INVOICE}function tN(t){return t&&t.docType===w.DOCTYPE_STATEMENT}var tP=th([ts({code:$,rate:X,taxable:tt,description:$}),(c={unit:$},void 0===f&&(h=B(c),f="Partial<".concat(h,">")),g=(d=Object.keys(c)).map(function(t){return c[t]}),v=d.length,new tu(f,function(t){if(tn.is(t)){for(var e=0;e<v;e++){var n=d[e],r=t[n];if(void 0!==r&&!c[n].is(r))return!1}return!0}return!1},function(t,e){var n=tn.validate(t,e);if(N(n))return n;for(var r=n.right,i=r,a=[],o=0;o<v;o++){var s=d[o],u=i[s],l=c[s],f=l.validate(u,V(e,s,l,u));if(N(f))void 0!==u&&J(a,f.left);else{var h=f.right;h!==u&&(i===r&&(i=j({},r)),i[s]=h)}}return a.length>0?k(a):U(i)},Y(g)?G:function(t){for(var e=j({},t),n=0;n<v;n++){var r=d[n],i=t[r];void 0!==i&&(e[r]=g[n].encode(i))}return e},c))]),tj=tc([ti(0),ti(1)]),tk=th([tP,ts({remoteId:$,quantity:X,taxRate:tc([X,z]),discountRate:tc([X,z]),discountType:tc([tj,z])})]),tx=/^[A-Za-z]*\d+$/,tU=td($,function(t){return"string"==typeof t&&tx.test(t.trim())},"ValidInvoiceNumber")},6323:function(t,e,n){(function(t){"use strict";var e={getItemSync:function(t){try{return localStorage.getItem(t)||null}catch(t){return null}},getItem:function(t,e){var n=this;return new Promise(function(r,i){try{var a=n.getItemSync(t);null==e||e(null,a),r(a)}catch(t){e&&e(t,null),i(t)}})},setItem:function(t,e,n){return new Promise(function(r,i){try{localStorage.setItem(t,e),n&&n(null,e),r(e)}catch(t){n&&n(t,null),i(t)}})}},r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e,n,r){return new(n||(n=Promise))(function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(o,s)}u((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var o=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(a=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!=i--;){var r,i,a,o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!=e&&n!=n};function s(t,e){var n=Object.keys(e||{}).filter(function(n){return!o(null==t?void 0:t[n],null==e?void 0:e[n])});return Object.keys(t||{}).filter(function(t){Object.keys(e||{}).includes(t)||n.push(t)}),Object.keys(n).length?n:null}function u(t,e,n){var r="shortString",i=!0;"number"==typeof n&&(r="javaDouble",i=!1),t[r]=t[r]||{},t[r][e]=i?n+"":n}(l=c||(c={})).NONE="NONE",l.DEFAULT_FLAGS="DEFAULT_FLAGS",l.CACHE="CACHE",l.SERVER="SERVER";var l,c,f,h,d=null,g="BULLET_TRAIN_DB",v="BULLET_TRAIN_EVENT",p="https://edge.api.flagsmith.com/api/v1/",y="flagsmith_value_",m="flagsmith_enabled_",_="flagsmith_trait_",S=function(){function t(t){var e=this;this._trigger=null,this._triggerLoadingState=null,this.timestamp=null,this.isLoading=!1,this.eventSource=null,this.getFlags=function(){var t=e.identity,n=e.api;e.log("Get Flags"),e.isLoading=!0,e.loadingState.isFetching||e.setLoadingState(r(r({},e.loadingState),{isFetching:!0}));var i=function(n){var i=n.flags,a=n.traits;e.isLoading=!1,t&&(e.withTraits=null);var o={},l={};a=a||[],(i=i||[]).forEach(function(t){o[t.feature.name.toLowerCase().replace(/ /g,"_")]={id:t.feature.id,enabled:t.enabled,value:t.feature_state_value}}),a.forEach(function(t){l[t.trait_key.toLowerCase().replace(/ /g,"_")]=t.trait_value}),e.oldFlags=r({},e.flags);var f=s(e.oldFlags,o),h=s(e.withTraits,l);if(e.flags=o,e.traits=l,e.updateStorage(),e._onChange(e.oldFlags,{isFromServer:!0,flagsChanged:f,traitsChanged:h},e._loadedState(null,c.SERVER)),e.datadogRum)try{if(e.datadogRum.trackTraits){var d={};Object.keys(e.traits).map(function(t){d[_+t]=e.getTrait(t)});var g=r(r(r({},e.datadogRum.client.getUser()),{id:e.datadogRum.client.getUser().id||e.identity}),d);e.log("Setting Datadog user",g),e.datadogRum.client.setUser(g)}}catch(t){console.error(t)}if(e.dtrum)try{var v={javaDouble:{},date:{},shortString:{},javaLongOrObject:{}};Object.keys(e.flags).map(function(t){u(v,y+t,e.getValue(t,{},!0)),u(v,m+t,e.hasFeature(t,!0))}),Object.keys(e.traits).map(function(t){u(v,_+t,e.getTrait(t))}),e.log("Sending javaLongOrObject traits to dynatrace",v.javaLongOrObject),e.log("Sending date traits to dynatrace",v.date),e.log("Sending shortString traits to dynatrace",v.shortString),e.log("Sending javaDouble to dynatrace",v.javaDouble),e.dtrum.sendSessionProperties(v.javaLongOrObject,v.date,v.shortString,v.javaDouble)}catch(t){console.error(t)}};return t?Promise.all([e.withTraits?e.getJSON(n+"identities/","POST",JSON.stringify({identifier:t,traits:Object.keys(e.withTraits).map(function(t){return{trait_key:t,trait_value:e.withTraits[t]}}).filter(function(t){return void 0!==t.trait_value||(e.log("Warning - attempted to set an undefined trait value for key",t.trait_key),!1)})})):e.getJSON(n+"identities/?identifier="+encodeURIComponent(t))]).then(function(t){return e.withTraits=null,i(t[0])}).catch(function(t){return Promise.reject(Error(t.message))}):e.getJSON(n+"flags/").then(function(t){return i({flags:t,traits:void 0})})},this.analyticsFlags=function(){var t=e.api;if(e.evaluationEvent&&e.evaluationEvent[e.environmentID])return e.evaluationEvent&&0!==Object.getOwnPropertyNames(e.evaluationEvent).length&&0!==Object.getOwnPropertyNames(e.evaluationEvent[e.environmentID]).length?e.getJSON(t+"analytics/flags/","POST",JSON.stringify(e.evaluationEvent[e.environmentID])).then(function(t){var n=e.getState();e.evaluationEvent||(e.evaluationEvent={}),e.evaluationEvent[e.environmentID]={},e.setState(r(r({},n),{evaluationEvent:e.evaluationEvent})),e.updateEventStorage()}).catch(function(t){e.log("Exception fetching evaluationEvent",t)}):void 0},this.datadogRum=null,this.loadingState={isLoading:!0,isFetching:!0,error:null,source:c.NONE},this.canUseStorage=!1,this.analyticsInterval=null,this.api=null,this.cacheFlags=!1,this.ts=null,this.enableAnalytics=!1,this.enableLogs=!1,this.environmentID="",this.evaluationEvent=null,this.flags=null,this.getFlagInterval=null,this.headers=null,this.initialised=!1,this.oldFlags=null,this.onChange=null,this.onError=null,this.identity=null,this.ticks=null,this.timer=null,this.traits=null,this.dtrum=null,this.withTraits=null,this.cacheOptions={ttl:0,skipAPI:!1},this.getValue=function(t,n,r){var i=e.flags&&e.flags[t.toLowerCase().replace(/ /g,"_")],a=null;if(i&&(a=i.value),r||e.evaluateFlag(t,"VALUE"),null===a&&void 0!==(null==n?void 0:n.fallback))return n.fallback;if(null==n?void 0:n.json)try{return null===a?(e.log("Tried to parse null flag as JSON: "+t),null):JSON.parse(a)}catch(t){return n.fallback}return a},this.getTrait=function(t){return e.traits&&e.traits[t.toLowerCase().replace(/ /g,"_")]},this.getAllTraits=function(){return e.traits},this.setTrait=function(t,n){if(e.api){var r={};return r[t]=n,e.setTraits(r)}},this.setTraits=function(t){if(e.api){if(t&&"object"==typeof t||console.error("Expected object for flagsmith.setTraits"),e.withTraits=r(r({},e.withTraits||{}),t),e.identity)return e.initialised?e.getFlags():void 0;e.log("Set traits prior to identifying",e.withTraits)}else console.error("Attempted to setTraits a user before calling flagsmith.init. Call flagsmith.init first, if you wish to prevent it sending a request for flags, call init with preventFetch:true.")},this.hasFeature=function(t,n){var r=e.flags&&e.flags[t.toLowerCase().replace(/ /g,"_")],i=!1;return r&&r.enabled&&(i=!0),n||e.evaluateFlag(t,"ENABLED"),i},this.getJSON=function(t,n,r){var i=e.environmentID,a=e.headers,o={method:n||"GET",body:r,cache:"no-cache",headers:{"x-environment-key":"".concat(i)}};n&&"GET"!==n&&(o.headers["Content-Type"]="application/json; charset=utf-8"),a&&Object.assign(o.headers,a),f||console.error("Flagsmith: fetch is undefined, please specify a fetch implementation into flagsmith.init to support SSR.");var s="".concat(e.identity);return f(t,o).then(function(r){var i,a="".concat(e.identity);if(s===a){var o=null===(i=r.headers)||void 0===i?void 0:i.get("x-flagsmith-document-updated-at");if(o)try{var u=parseFloat(o);if(isNaN(u))return Promise.reject("Failed to parse x-flagsmith-document-updated-at");e.timestamp=u}catch(t){e.log(t,"Failed to parse x-flagsmith-document-updated-at",o)}return e.log("Fetch response: "+r.status+" "+(n||"GET")+"0"+t),r.text().then(function(t){var e=t;try{e=JSON.parse(t)}catch(t){}return!e&&r.status&&(e="API Response: ".concat(r.status)),r.status&&r.status>=200&&r.status<300?e:Promise.reject(Error(e))})}e.log("Received response with identity miss-match, ignoring response. Requested: ".concat(s,", Current: ").concat(a))})},this.evaluateFlag=function(t,n){if(e.datadogRum&&(e.datadogRum.client.addFeatureFlagEvaluation?"VALUE"===n?e.datadogRum.client.addFeatureFlagEvaluation(y+t,e.getValue(t,{},!0)):e.datadogRum.client.addFeatureFlagEvaluation(m+t,e.hasFeature(t,!0)):console.error("Flagsmith: Your datadog RUM client does not support the function addFeatureFlagEvaluation, please update it.")),e.enableAnalytics){if(!e.evaluationEvent)return;e.evaluationEvent[e.environmentID]||(e.evaluationEvent[e.environmentID]={}),void 0===e.evaluationEvent[e.environmentID][t]&&(e.evaluationEvent[e.environmentID][t]=0),e.evaluationEvent[e.environmentID][t]+=1}e.updateEventStorage()},this._onChange=function(t,n,r){var i,a;e.setLoadingState(r),null===(i=e.onChange)||void 0===i||i.call(e,t,n,e.loadingState),null===(a=e._trigger)||void 0===a||a.call(e)},f=t.fetch?t.fetch:"undefined"!=typeof fetch?fetch:null===n.g||void 0===n.g?void 0:n.g.fetch,this.canUseStorage="undefined"!=typeof window||!!t.browserlessStorage,this.log("Constructing flagsmith instance "+t),t.eventSource&&(h=t.eventSource),t.AsyncStorage&&(d=t.AsyncStorage)}return t.prototype.init=function(t){var e;return i(this,void 0,void 0,function(){var n,o,u,l,h,y,m,_,S,E,b,O,T,I,w,A,F,C,R,L,D,N,P,j,k,x,U,M,G,V,J,Z=this;return a(this,function(Y){switch(Y.label){case 0:if(Y.trys.push([0,12,,13]),n=t.environmentID,u=void 0===(o=t.api)?p:o,l=t.headers,h=t.onChange,y=t.cacheFlags,m=t.datadogRum,_=t.onError,S=t.defaultFlags,E=t.fetch,b=t.preventFetch,O=t.enableLogs,T=t.enableDynatrace,I=t.enableAnalytics,w=t.realtime,F=void 0===(A=t.eventSourceUrl)?"https://realtime.flagsmith.com/":A,C=t.AsyncStorage,R=t.identity,L=t.traits,D=t.state,N=t.cacheOptions,P=t.angularHttpClient,j=t._trigger,k=t._triggerLoadingState,this.environmentID=n,this.api=u,this.headers=l,this.getFlagInterval=null,this.analyticsInterval=null,this.onChange=h,x="Wrong Flagsmith Configuration: preventFetch is true and no defaulFlags provided",this._trigger=j||this._trigger,this._triggerLoadingState=k||this._triggerLoadingState,this.onError=function(t){Z.setLoadingState(r(r({},Z.loadingState),{isFetching:!1,isLoading:!1,error:t})),null==_||_(t)},this.identity=R,this.withTraits=L,this.enableLogs=O||!1,this.cacheOptions=N?{skipAPI:!!N.skipAPI,ttl:N.ttl||0}:this.cacheOptions,!this.cacheOptions.ttl&&this.cacheOptions.skipAPI&&console.warn("Flagsmith: you have set a cache ttl of 0 and are skipping API calls, this means the API will not be hit unless you clear local storage."),E&&(f=E),this.enableAnalytics=I||!1,this.flags=Object.assign({},S)||{},this.traits=Object.assign({},L)||{},this.datadogRum=m||null,this.initialised=!0,this.ticks=1e4,this.timer=this.enableLogs?(new Date).valueOf():null,this.cacheFlags=void 0!==d&&!!y,C&&(d=C),w&&"undefined"!=typeof window&&this.setupRealtime(F,n),Object.keys(this.flags).length&&(this.loadingState=r(r({},this.loadingState),{isLoading:!1,source:c.DEFAULT_FLAGS})),this.setState(D),this.log("Initialising with properties",t,this),!n)throw Error("Please specify a environment id");if(T&&("undefined"==typeof dtrum?console.error("You have attempted to enable dynatrace but dtrum is undefined, please check you have the Dynatrace RUM JavaScript API installed."):this.dtrum=dtrum),P&&(f=function(t,e){var n=e.headers,r=e.method,i=e.body;return new Promise(function(e){switch(r){case"GET":return P.get(t,{headers:n}).subscribe(function(t){e({ok:!0,text:function(){return Promise.resolve(t)}})});case"POST":case"PUT":return P.post(t,i,{headers:n}).subscribe(function(t){e({ok:!0,text:function(){return Promise.resolve(t)}})})}})}),d&&this.canUseStorage&&d.getItem(v).then(function(t){try{Z.evaluationEvent=JSON.parse(t)||{}}catch(t){Z.evaluationEvent={}}Z.analyticsInterval=setInterval(Z.analyticsFlags,Z.ticks)}),this.enableAnalytics&&(this.analyticsInterval&&clearInterval(this.analyticsInterval),d&&this.canUseStorage&&d.getItem(v,function(t,e){if(e){var n=JSON.parse(e);if(n[Z.environmentID]){var i=Z.getState();Z.log("Retrieved events from cache",e),Z.setState(r(r({},i),{evaluationEvent:n[Z.environmentID]}))}}})),!y)return[3,8];if(!d||!this.canUseStorage)return[3,7];U=function(t,e){return i(Z,void 0,void 0,function(){var t,n,r,i,o,u,l;return a(this,function(a){switch(a.label){case 0:if(!e)return[3,7];t=null,n=null,a.label=1;case 1:return a.trys.push([1,5,,6]),r=JSON.parse(e),i=!1,r&&r.api===this.api&&r.environmentID===this.environmentID&&(o=!0,this.identity&&r.identity!==this.identity&&(this.log("Ignoring cache,  identity has changed from "+r.identity+" to "+this.identity),o=!1),this.cacheOptions.ttl&&(!r.ts||(new Date).valueOf()-r.ts>this.cacheOptions.ttl)&&r.ts&&(this.log("Ignoring cache, timestamp is too old ts:"+r.ts+" ttl: "+this.cacheOptions.ttl+" time elapsed since cache: "+((new Date).valueOf()-r.ts)+"ms"),o=!1),o&&(i=!0,n=s(this.traits,r.traits),t=s(this.flags,r.flags),this.setState(r),this.log("Retrieved flags from cache",r))),i?(u=!(b||this.cacheOptions.skipAPI&&i),this._onChange(null,{isFromServer:!1,flagsChanged:t,traitsChanged:n},this._loadedState(null,c.CACHE,u)),this.oldFlags=this.flags,this.cacheOptions.skipAPI&&i&&this.log("Skipping API, using cache"),u&&this.getFlags(),[3,4]):[3,2];case 2:return b?[3,4]:[4,this.getFlags()];case 3:a.sent(),a.label=4;case 4:return[3,6];case 5:return l=a.sent(),this.log("Exception fetching cached logs",l),[3,6];case 6:return[3,10];case 7:return b?[3,9]:[4,this.getFlags()];case 8:return a.sent(),[3,10];case 9:if(S)this._onChange(null,{isFromServer:!1,flagsChanged:s({},this.flags),traitsChanged:s({},this.traits)},this._loadedState(null,c.DEFAULT_FLAGS));else{if(!this.flags)throw Error(x);this._onChange(null,{isFromServer:!1,flagsChanged:s({},this.flags),traitsChanged:s({},this.traits)},this._loadedState(null,c.DEFAULT_FLAGS))}a.label=10;case 10:return[2]}})})},Y.label=1;case 1:return Y.trys.push([1,6,,7]),d.getItemSync?(M=d.getItemSync(g),[3,4]):[3,2];case 2:return[4,d.getItem(g)];case 3:M=Y.sent(),Y.label=4;case 4:return[4,U(null,M)];case 5:case 6:return Y.sent(),[3,7];case 7:return[3,11];case 8:return b?[3,10]:[4,this.getFlags()];case 9:return Y.sent(),[3,11];case 10:if(S)this._onChange(null,{isFromServer:!1,flagsChanged:s({},S),traitsChanged:s({},L)},this._loadedState(null,c.DEFAULT_FLAGS));else if(this.flags&&(G=null,0===Object.keys(this.flags).length&&(G=x),this._onChange(null,{isFromServer:!1,flagsChanged:s({},this.flags),traitsChanged:s({},L)},this._loadedState(G,c.DEFAULT_FLAGS)),G))throw Error(G);Y.label=11;case 11:return[3,13];case 12:throw V=Y.sent(),this.log("Error during initialisation ",V),J=V instanceof Error?V:Error("".concat(V)),null===(e=this.onError)||void 0===e||e.call(this,J),V;case 13:return[2]}})})},t.prototype._loadedState=function(t,e,n){return void 0===t&&(t=null),void 0===n&&(n=!1),{error:t,isFetching:n,isLoading:!1,source:e}},t.prototype.getAllFlags=function(){return this.flags},t.prototype.identify=function(t,e){return this.identity&&this.identity!==t&&(this.withTraits={}),this.identity=t,this.log("Identify: "+this.identity),e&&(this.withTraits=r(r({},this.withTraits||{}),e)),this.initialised?this.getFlags():Promise.resolve()},t.prototype.getState=function(){return{api:this.api,environmentID:this.environmentID,flags:this.flags,identity:this.identity,ts:this.ts,traits:this.traits,evaluationEvent:this.evaluationEvent}},t.prototype.setState=function(t){t&&(this.initialised=!0,this.api=t.api||this.api||p,this.environmentID=t.environmentID||this.environmentID,this.flags=t.flags||this.flags,this.identity=t.identity||this.identity,this.traits=t.traits||this.traits,this.withTraits=r(r({},this.withTraits||{}),this.traits),this.evaluationEvent=t.evaluationEvent||this.evaluationEvent,this.log("setState called",this))},t.prototype.logout=function(){return this.identity=null,this.traits={},this.initialised?this.getFlags():Promise.resolve()},t.prototype.startListening=function(t){void 0===t&&(t=1e3),this.getFlagInterval&&clearInterval(this.getFlagInterval),this.getFlagInterval=setInterval(this.getFlags,t)},t.prototype.stopListening=function(){this.getFlagInterval&&(clearInterval(this.getFlagInterval),this.getFlagInterval=null)},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enableLogs&&console.log.apply(this,function(t,e,n){if(n||2==arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}(["FLAGSMITH:",(new Date).valueOf()-(this.timer||0),"ms"],t,!0))},t.prototype.updateStorage=function(){if(this.cacheFlags){this.ts=(new Date).valueOf();var t=JSON.stringify(this.getState());this.log("Setting storage",t),d.setItem(g,t)}},t.prototype.updateEventStorage=function(){if(this.enableAnalytics){var t=JSON.stringify(this.getState().evaluationEvent);d.setItem(v,t)}},t.prototype.setLoadingState=function(t){var e;o(t,this.loadingState)||(this.loadingState=r({},t),this.log("Loading state changed",t),null===(e=this._triggerLoadingState)||void 0===e||e.call(this))},t.prototype.setupRealtime=function(t,e){var n=this,r=t+"sse/environments/"+e+"/stream";h?this.eventSource||(this.log("Creating event source with url "+r),this.eventSource=new h(r),this.eventSource.addEventListener("environment_updated",function(t){var e;try{e=JSON.parse(t.data).updated_at}catch(t){n.log("Could not parse sse event",t)}e?!n.timestamp||e>n.timestamp?n.isLoading?n.log("updated_at is new, but flags are loading",t.data,n.timestamp):(n.log("updated_at is new, fetching flags",t.data,n.timestamp),n.getFlags()):n.log("updated_at is outdated, skipping get flags",t.data,n.timestamp):n.log("No updated_at received, fetching flags",t)})):this.log("Error, EventSource is undefined")},t}();function E(t){return new S({fetch:t.fetch,AsyncStorage:t.AsyncStorage,eventSource:t.eventSource})}var b,O=(b=function(t,e){return(b=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},I=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},w=function(t,e,n){if(n||2==arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},A=function(t){function e(){return t.call(this,"EventSource not available.\nConsider loading an EventSource polyfill and making it available globally as EventSource, or passing one in as eventSourceClass to the ReconnectingEventSource constructor.")||this}return O(e,t),e}(Error),F=function(){function t(t,e){var n=this;if(this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,this._configuration=null!=e?Object.assign({},e):void 0,this.withCredentials=!1,this._eventSource=null,this._lastEventId=null,this._timer=null,this._listeners={open:[],error:[],message:[]},this.url=t.toString(),this.readyState=this.CONNECTING,this.max_retry_time=3e3,this.eventSourceClass=globalThis.FlagsmithEventSource,null!=this._configuration&&(this._configuration.lastEventId&&(this._lastEventId=this._configuration.lastEventId,delete this._configuration.lastEventId),this._configuration.max_retry_time&&(this.max_retry_time=this._configuration.max_retry_time,delete this._configuration.max_retry_time),this._configuration.eventSourceClass&&(this.eventSourceClass=this._configuration.eventSourceClass,delete this._configuration.eventSourceClass)),null==this.eventSourceClass||"function"!=typeof this.eventSourceClass)throw new A;this._onevent_wrapped=function(t){n._onevent(t)},this._start()}return t.prototype.dispatchEvent=function(t){throw Error("Method not implemented.")},t.prototype._start=function(){var t,e,n=this,r=this.url;this._lastEventId&&(-1===r.indexOf("?")?r+="?":r+="&",r+="lastEventId="+encodeURIComponent(this._lastEventId)),this._eventSource=new this.eventSourceClass(r,this._configuration),this._eventSource.onopen=function(t){n._onopen(t)},this._eventSource.onerror=function(t){n._onerror(t)},this._eventSource.onmessage=function(t){n.onmessage(t)};try{for(var i=T(Object.keys(this._listeners)),a=i.next();!a.done;a=i.next()){var o=a.value;this._eventSource.addEventListener(o,this._onevent_wrapped)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype._onopen=function(t){0===this.readyState&&(this.readyState=1,this.onopen(t))},t.prototype._onerror=function(t){var e=this;if(1===this.readyState&&(this.readyState=0,this.onerror(t)),this._eventSource){this._eventSource.close(),this._eventSource=null;var n=Math.round(this.max_retry_time*Math.random());this._timer=setTimeout(function(){return e._start()},n)}},t.prototype._onevent=function(t){t&&t.lastEventId&&(this._lastEventId=t.lastEventId);var e,n,r=this._listeners[t.type];if(null!=r)try{for(var i=T(w([],I(r),!1)),a=i.next();!a.done;a=i.next())a.value.call(this,t)}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}"message"===t.type&&this.onmessage(t)},t.prototype.onopen=function(t){},t.prototype.onerror=function(t){},t.prototype.onmessage=function(t){},t.prototype.close=function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._eventSource&&(this._eventSource.close(),this._eventSource=null),this.readyState=2},t.prototype.addEventListener=function(t,e,n){null==this._listeners[t]&&(this._listeners[t]=[],null!=this._eventSource&&this._eventSource.addEventListener(t,this._onevent_wrapped));var r=this._listeners[t];r.includes(e)||(this._listeners[t]=w(w([],I(r),!1),[e],!1))},t.prototype.removeEventListener=function(t,e,n){var r=this._listeners[t];this._listeners[t]=r.filter(function(t){return t!==e})},t}();globalThis.FlagsmithEventSource="undefined"!=typeof EventSource?EventSource:null;var C=E({AsyncStorage:e,eventSource:"undefined"!=typeof window?F:null});"undefined"!=typeof window&&(window.flagsmith=C),t.createFlagsmithInstance=function(){return E({AsyncStorage:e,eventSource:"undefined"!=typeof window?F:null})},t.default=C,Object.defineProperty(t,"__esModule",{value:!0})})(e)},50092:function(t,e,n){var r,i,a,o,s,u,l,c,f;r=e,i=n(58078),a=i&&"object"==typeof i&&"default"in i?i:{default:i},o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=new(function(){function t(){this.e={}}return t.prototype.generateCallbackId=function(){return Math.random().toString(36).substring(7)},t.prototype.on=function(t,e,n){var r=this,i=this.e||(this.e={}),a=this.generateCallbackId();return(i[t]||(i[t]=[])).push({id:a,fn:e,ctx:n}),(function(){r.off(t,a)}).bind(this)},t.prototype.once=function(t,e,n){var r=this,i=this.generateCallbackId();function a(){r.off(t,i),e.apply(n,arguments)}return a._=e,this.on(t,a,n)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=((this.e||(this.e={}))[t]||[]).slice(),i=r.length,a=0;a<i;a++)r[a].fn.apply(r[a].ctx,e);return this},t.prototype.off=function(t,e,n){var r=this.e||(this.e={}),i=r[t],a=[];if(i&&e)for(var o=0,s=i.length;o<s;o++)("function"==typeof e&&i[o].fn!==e||"string"==typeof e&&i[o].id!==e)&&a.push(i[o]);return a.length?r[t]=a:delete r[t],this},t}()),u=i.createContext(null),l=function(t){var e=i.useRef(t);return e.current||(e.current=t),e.current},c=function(t){if("string"==typeof t)return[t];if("object"==typeof t&&t.hasOwnProperty("length"))return t;throw Error("Flagsmith: please supply an array of strings or a single string of flag keys to useFlags")},f=function(t,e,n){return void 0===n&&(n=[]),e.map(function(e){return"".concat(t.getValue(e)).concat(t.hasFeature(e))}).concat(n.map(function(e){return"".concat(t.getTrait(e))})).join(",")},r.FlagsmithContext=u,r.FlagsmithProvider=function(t){var e=t.flagsmith,n=t.options,r=t.serverState,l=t.children,c=i.useRef(!0);return!e||(null==e?void 0:e._trigger)||(e._trigger=function(){e.log("React - trigger event received"),s.emit("event")}),!e||(null==e?void 0:e._triggerLoadingState)||(e._triggerLoadingState=function(){s.emit("loading_event")}),r&&!e.initialised&&e.setState(r),c.current&&(c.current=!1,n&&e.init(o(o({},n),{state:n.state||r,onChange:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.onChange&&n.onChange.apply(n,t)}}))),a.default.createElement(u.Provider,{value:e},l)},r.useFlags=function(t,e){void 0===e&&(e=[]);var n=i.useRef(!0),r=l(c(t)),a=l(c(e)),o=i.useContext(u),h=i.useState(f(o,r,a)),d=h[0],g=h[1],v=i.useCallback(function(){var t=f(o,r,a);t!==d&&(null==o||o.log("React - useFlags flags and traits have changed"),g(t))},[d]),p=i.useRef(s.once("event",v));return n.current&&(n.current=!1,null==o||o.log("React - Initialising event listeners")),i.useEffect(function(){return function(){var t;null===(t=p.current)||void 0===t||t.call(p)}},[]),i.useMemo(function(){var t={};return r.map(function(e){t[e]={enabled:o.hasFeature(e),value:o.getValue(e)}}).concat(null==a?void 0:a.map(function(e){t[e]=o.getTrait(e)})),t},[d])},r.useFlagsmith=function(){var t=i.useContext(u);if(!t)throw Error("useFlagsmith must be used with in a FlagsmithProvider");return t},r.useFlagsmithLoading=function(){var t=i.useContext(u),e=i.useState(null==t?void 0:t.loadingState),n=e[0],r=e[1],a=i.useState(!1),o=a[0],l=a[1],c=i.useRef(o),f=i.useCallback(function(){r(null==t?void 0:t.loadingState)},[t]);return c.current||(s.on("loading_event",f),c.current=!0),i.useEffect(function(){return!o&&(null==t?void 0:t.initialised)&&(s.on("loading_event",f),l(!0)),function(){o&&s.off("loading_event",f)}},[t,o,f]),n},Object.defineProperty(r,"__esModule",{value:!0})},83257:function(t,e,n){"use strict";var r=n(2239),i=n(28957);e.Z=function(t,e,n){var a=(t=t||{}).random||(t.rng||r.Z)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=a[o];return e}return(0,i.Z)(a)}}}]);